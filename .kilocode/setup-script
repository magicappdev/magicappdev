#!/bin/bash
# Kilo Code Worktree Setup Script
# This script runs before the agent starts in a worktree (new sessions only).
#
# Available environment variables:
WORKTREE_PATH = "D:\\repos\\magicappdev.worktrees\\kilocode-devcontainer" #- Absolute path to the worktree directory
REPO_PATH = "D:\\repos\\magicappdev"    #  - Absolute path to the main repository
#
# Example tasks:
- Copy .env files from main repo
- Copy .devcontainer files
- Install dependencies
-  Analyze code
- Prepare environment
- For building a comprehansive dev enviroment for the magicappdev monorepo using devcontainer, docker and vscode
- Checkout the magicappdev monorepo ( Dev tools, needs , workflows and scripts )
- Set up devcontainer
- Build devcontainer
- Update Documentation + dev workflow
#   - Set up local configuration

set -e  # Exit on error

echo "Setting up worktree: $WORKTREE_PATH"

# Uncomment and modify as needed:

# Copy environment files
if [ -f "$REPO_PATH/.env" ]; then
    cp "$REPO_PATH/.env" "$WORKTREE_PATH/.env"
    echo "Copied .env"
fi

# Install dependencies (Node.js)
if [ -f "$WORKTREE_PATH/package.json" ]; then
    cd "$WORKTREE_PATH"
    pnpm install
fi

# Install dependencies (Python)
# if [ -f "$WORKTREE_PATH/requirements.txt" ]; then
#     cd "$WORKTREE_PATH"
#     pip install -r requirements.txt
# fi

echo "Setup complete!"
